# annotation_labeling.py

import json

# Load preprocessed data
with open("preprocessed_data.json", "r") as infile:
    preprocessed_data = json.load(infile)

# Your annotation and labeling code goes here
# Add labels or annotations to the data

# Example: Annotated data with logic
annotated_data = []
for entry in preprocessed_data:
    # Define labels for each entry
    labels = []

    # Apply logic to determine labels based on vulnerability characteristics
    if "SQL injection" in entry["Cleaned_Description"]:
        labels.append("vulnerability type: SQL injection")
        labels.append("severity: high")
        labels.append("attack vector: network-based")
        labels.append("patch availability: patch available")
        labels.append("mitigation steps: Apply vendor patch immediately")
    else:
        labels.append("vulnerability type: Other")
        labels.append("severity: low")
        labels.append("attack vector: unknown")
        labels.append("patch availability: patch not available")
        labels.append("mitigation steps: Monitor for updates")

    # Add labels to the entry
    entry["Labels"] = labels

    # Append the annotated entry to the list
    annotated_data.append(entry)

# Save annotated data as JSON
with open("annotated_data.json", "w") as outfile:
    json.dump(annotated_data, outfile)
