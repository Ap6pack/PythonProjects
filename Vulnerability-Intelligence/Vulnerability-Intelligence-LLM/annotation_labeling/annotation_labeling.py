# annotation_labeling.py

import json

# Load preprocessed data
with open("preprocessed_data.json", "r") as infile:
    preprocessed_data = json.load(infile)

# Your annotation and labeling code goes here
# Add labels or annotations to the data

# Example: Annotated data
annotated_data = []
for entry in preprocessed_data:
    # Define the labels for each entry
    labels = []

    # Example: Determine labels based on severity and vulnerability type
    if "SQL injection" in entry["Cleaned_Description"]:
        labels.append("vulnerability: SQL injection")
        labels.append("severity: high")
    else:
        labels.append("severity: low")
        labels.append("vulnerability: other")

    # Add labels to the entry
    entry["Labels"] = labels

    # Append the annotated entry to the list
    annotated_data.append(entry)

# Save annotated data as JSON
with open("annotated_data.json", "w") as outfile:
    json.dump(annotated_data, outfile)
