# annotation_labeling.py

import json

# Load preprocessed data
with open("preprocessed_data.json", "r") as infile:
    preprocessed_data = json.load(infile)

# Your annotation and labeling code goes here
# Add labels or annotations to the data

# Example: Annotated data
annotated_data = []
for entry in preprocessed_data:
    # Define labels for each entry
    labels = []

    # Define labeling criteria based on your project's needs
    labels.append("vulnerability type: SQL injection")
    labels.append("severity: high")
    labels.append("affected software: Software A, Software B")
    labels.append("exploitability: actively exploited")
    labels.append("attack vector: network-based")
    labels.append("patch availability: patch available")
    labels.append("impact description: data leakage")
    labels.append("CVE source: Security Researcher XYZ")
    labels.append("affected versions: v1.0 - v2.5")
    labels.append("CVSS score: 9.8 (Critical)")
    labels.append("mitigation steps: Apply vendor patch immediately")

    # Add labels to the entry
    entry["Labels"] = labels

    # Append the annotated entry to the list
    annotated_data.append(entry)

# Save annotated data as JSON
with open("annotated_data.json", "w") as outfile:
    json.dump(annotated_data, outfile)
